{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/amalegalsolutions/Desktop/jivoenergy/src/components/HexedGlobe.tsx"],"sourcesContent":["'use client'\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport Globe, { GlobeMethods } from 'react-globe.gl';\nimport * as d3 from 'd3';\n\ninterface CountryProperties {\n  ADMIN: string;\n  ISO_A2: string;\n  ISO_A3: string;\n  POP_EST: number;\n  [key: string]: any;\n}\n\ninterface CountryFeature {\n  type: string;\n  geometry: {\n    type: string;\n    coordinates: number[][][];\n  };\n  properties: CountryProperties;\n}\n\ninterface CountryData extends CountryFeature {\n  __hover?: boolean;\n  __color?: string;\n}\n\ninterface HexedGlobeProps {\n  countryGeoJsonUrl?: string;\n  hexPolygonResolution?: number;\n  hexPolygonColor?: string | ((d: CountryData) => string);\n  onCountryClick?: (country: CountryData, coords: { lat: number; lng: number; altitude: number }) => void;\n  onCountryHover?: (country: CountryData | null, prevCountry: CountryData | null) => void;\n}\n\n// Default GeoJSON URL - Natural Earth dataset\nconst DEFAULT_GEOJSON_URL = 'https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_admin_0_countries.geojson';\n\n// Generate a stable color based on a string\nconst getStableColor = (str: string): string => {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  const hue = Math.abs(hash % 360);\n  return `hsl(${hue}, 70%, 60%)`;\n};\n\nexport default function HexedGlobe({\n  countryGeoJsonUrl = DEFAULT_GEOJSON_URL,\n  hexPolygonResolution = 3,\n  hexPolygonColor,\n  onCountryClick,\n  onCountryHover,\n}: HexedGlobeProps) {\n  const globeRef = useRef<GlobeMethods>(undefined);\n  const [countries, setCountries] = useState<CountryData[]>([]);\n  const [hoveredCountry, setHoveredCountry] = useState<CountryData | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const hoverTimeoutRef = useRef<NodeJS.Timeout>();\n\n  // Fetch GeoJSON data\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        setIsLoading(true);\n        const response = await fetch(countryGeoJsonUrl);\n        const data = await response.json();\n        \n        // Transform the GeoJSON features into the format needed by the Globe\n        const countryHexData = data.features.map((feat: CountryFeature) => ({\n          ...feat,\n          __hover: false,\n          __color: hexPolygonColor \n            ? (typeof hexPolygonColor === 'function' ? hexPolygonColor(feat as CountryData) : hexPolygonColor)\n            : getStableColor(feat.properties.ISO_A3 || feat.properties.ADMIN)\n        }));\n        \n        setCountries(countryHexData);\n      } catch (error) {\n        console.error('Error loading country data:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchData();\n  }, [countryGeoJsonUrl, hexPolygonColor]);\n\n  // Initialize globe settings\n  useEffect(() => {\n    if (globeRef.current) {\n      // Auto-rotate\n      (globeRef.current as any).controls().autoRotate = true;\n      (globeRef.current as any).controls().autoRotateSpeed = 0.5;\n      \n      // Set initial camera position\n      (globeRef.current as any).pointOfView({\n        lat: 0,\n        lng: 0,\n        altitude: 2\n      });\n\n      // Enable zoom and pan\n      (globeRef.current as any).controls().enableZoom = true;\n      (globeRef.current as any).controls().enablePan = true;\n    }\n  }, []);\n\n  // Cleanup timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (hoverTimeoutRef.current) {\n        clearTimeout(hoverTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  // Handle country hover with debounce\n  const handleCountryHover = useCallback((country: CountryData | null, prevCountry: CountryData | null) => {\n    if (hoverTimeoutRef.current) {\n      clearTimeout(hoverTimeoutRef.current);\n    }\n\n    hoverTimeoutRef.current = setTimeout(() => {\n      setCountries(prevCountries => \n        prevCountries.map(c => ({\n          ...c,\n          __hover: c === country\n        }))\n      );\n      \n      setHoveredCountry(country);\n      if (onCountryHover) {\n        onCountryHover(country, prevCountry);\n      }\n    }, 50); // Small delay to prevent rapid state changes\n  }, [onCountryHover]);\n\n  // Handle country click\n  const handleCountryClick = useCallback((country: CountryData, event: MouseEvent, coords: { lat: number; lng: number; altitude: number }) => {\n    if (onCountryClick) {\n      onCountryClick(country, coords);\n    }\n  }, [onCountryClick]);\n\n  if (isLoading) {\n    return (\n      <div style={{ \n        width: '100%', \n        height: '100%', \n        display: 'flex', \n        alignItems: 'center', \n        justifyContent: 'center',\n        backgroundColor: '#f5f5f5'\n      }}>\n        <div style={{ textAlign: 'center' }}>\n          <div style={{ \n            width: '40px', \n            height: '40px', \n            border: '4px solid #f3f3f3',\n            borderTop: '4px solid #3498db',\n            borderRadius: '50%',\n            animation: 'spin 1s linear infinite',\n            margin: '0 auto 10px'\n          }} />\n          <p>Loading world data...</p>\n        </div>\n        <style jsx>{`\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        `}</style>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ width: '100%', height: '100%', position: 'relative' }}>\n      <Globe\n        ref={globeRef}\n        globeImageUrl=\"//cdn.jsdelivr.net/npm/three-globe/example/img/earth-dark.jpg\"\n        hexPolygonsData={countries}\n        hexPolygonGeoJsonGeometry={(d: any) => d.geometry}\n        hexPolygonLabel={(d: any) => `\n          <div>\n            <div><b>${d.properties.ADMIN} (${d.properties.ISO_A2})</b></div>\n            <div>Population: <i>${d.properties.POP_EST?.toLocaleString()}</i></div>\n          </div>\n        `}\n        hexPolygonColor={(d: any) => d.__hover ? '#ff9900' : d.__color}\n        hexPolygonAltitude={(d: any) => d.__hover ? 0.02 : 0.001}\n        hexPolygonResolution={hexPolygonResolution}\n        hexPolygonMargin={0.3}\n        hexPolygonUseDots={true}\n        hexPolygonsTransitionDuration={200}\n        onHexPolygonClick={(d: any, event: MouseEvent, coords: { lat: number; lng: number; altitude: number }) => \n          handleCountryClick(d, event, coords)\n        }\n        onHexPolygonHover={(d: any, prev: any) => \n          handleCountryHover(d, prev)\n        }\n      />\n      {hoveredCountry && (\n        <div\n          style={{\n            position: 'absolute',\n            top: '10px',\n            left: '10px',\n            backgroundColor: 'rgba(255, 255, 255, 0.9)',\n            padding: '10px',\n            borderRadius: '5px',\n            boxShadow: '0 2px 4px rgba(0,0,0,0.2)',\n            zIndex: 1000,\n            transition: 'opacity 0.2s ease-in-out',\n            opacity: 1,\n          }}\n        >\n          <h3 style={{ margin: 0 }}>{hoveredCountry.properties.ADMIN}</h3>\n          <p style={{ margin: '5px 0 0 0' }}>\n            ISO: {hoveredCountry.properties.ISO_A2}\n          </p>\n          <p style={{ margin: '5px 0 0 0' }}>\n            Population: {hoveredCountry.properties.POP_EST?.toLocaleString()}\n          </p>\n        </div>\n      )}\n    </div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}}]
}